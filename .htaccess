<IfModule mod_headers.c>
        # The X-Frame-Options HTTP response header can be used to indicate whether
        # or not a browser should be allowed to render a page in a <frame>, <iframe> or <object> .
        Header always set X-Frame-Options SAMEORIGIN

        # Content Security Policy (CSP) prevent cross-site scripting (XSS), clickjacking and other code injection attacks resulting from execution of malicious content in the trusted web page context.
        Header set Content-Security-Policy "default-src 'none'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src data:; connect-src 'self'"
        Header set X-Content-Security-Policy "default-src 'none'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src data:; connect-src 'self'"
        Header set X-WebKit-CSP "default-src 'none'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src data:; connect-src 'self'"

        # The Set-Cookie HTTP response header is used to send a cookie from the server to the user agent, so that the user agent can send it back to the server later. 
	Header always edit Set-Cookie (.*) "$1; HTTPOnly; Secure; SameSite=Strict"

        # The Access-Control-Allow-Origin response header indicates whether the response can be shared with requesting code from the given origin.
	Header set Access-Control-Allow-Origin "none"

        # The X-Content-Type-Options header with the value nosniff ensures that user agents do not attempt to guess the format of the data being received.
	Header set X-Content-Type-Options "nosniff"

        # Stop page from loading when they detected reflected cross-site scripting (XSS) attacks.
	Header set X-XSS-Protection "1; mode=block"
</IfModule>

# Disable directory indexing
Options -Indexes

# Deny access to LookingGlass subdirectory
# Overkill, but used for development (dev folder = /LookingGlass)
RedirectMatch 404 /LookingGlass/(.*\.(?:conf|db|sh)|(?:Config|LookingGlass|RateLimit)\.php)$

# Deny access to hidden files/folders
RedirectMatch 404 /\.

# Disable gzip for test files
SetEnvIf Request_URI \.bin$ no-gzip dont-vary